<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>etherscan_k</title>
</head>
<body>
    <h1>etherscan_k</h1>
    <div calss="first">
        <input type="text" id="allSearch" placeholder="Search by Address / Txt Hash / block / Token"/>
        <button onclick="allSearch()">Search</button>
    </div>
    <table id="blockWriteTable"></table>
    <br/><br/>
    <script type="text/javascript" src="./lib/bignumber.min.js"></script>
    <!--<script type="text/javascript" src="./lib/web3.js"></script>-->
    <script src="./dist/web3.min.js"></script>

    <script type="text/javascript">
        let web3 = new Web3(Web3.givenProvider || "http://lacalhost:8545");
        let accounts;
        
        async function allSearch() {
            let search = document.getElementById("allSearch").value;
            if (search.length < 42) {
                var blockNumberr = document.getElementById("allSearch").value;

                await web3.eth.getBlock(
                    blockNumberr, function(error, block) {
                        console.log(block);
                        let list = "";
                        for (var j in block) {
                            console.log("forin",j);
                            console.log("forin", block[j]);

                            if(j == "transactions") {
                                list += 
                                    "<tr><td>" +
                                j +
                                    "</td><td onclick='aa()' id='esId" +
                                block[j] +
                                    "</td></tr>";
                            } else {
                                list +=
                                    "<tr><td>" +
                                j +
                                    "</td><td>" +
                                block[j] +
                                    "</td></tr>";
                                }
                            }
                            document.getElementById(
                                "blockWruiteTable"
                            ).innerHTML = list;
                            }
                        );
                    } else if (search.length < 66) {
                        let balance = await web3.eth.getBalance(serch);
                        let list =
                            "<tr><td>" +
                            search +
                            "</td><td>" +
                            balance +
                            "</td></tr>";
                        //console.log(balance.length);
                        document.getElementById("blockWriteTable").innerHTML = list;
                    } else if {
                        var transactionNumber =
                            document.getElementById("allSearch").value;
                        console.log(transactionNumberr);

                        await web3.eth.getTransaction(
                            transactionNumberr,
                            function (error,tx) {
                                console.log(tx);

                                let list = "";
                                // web3.eth.getBlock(
                                //     tx.blockNumber,
                                //     function (error, block) {
                                //         console.log(block);
                                //         timestamp = new Date(
                                //             block.timestamp *1000
                                //         );
                                //     }
                                // );
                                for (var j in tx) {
                                    console.log("forin", j);
                                    console.log("forin", tx[j]);

                                    if(j == "blockNumber") {
                                        list +=
                                            "<tr><td>" +
                                            j +
                                            "</td><td onclick='blockN()' id='blockNum'>" +
                                            tx[j] +
                                            "</td></tr>";
                                    } else if (j == "from") {
                                        list +=
                                            "<tr><td>" +
                                            j +
                                            "</td><td onclick='fromGo()' id='fromGo'>" +
                                            tx[j] +
                                            "</td></tr>";
                                    } else {
                                        list +=accounts
                                            "<tr><td>" +
                                            tx[j] +
                                            "</td></tr>";
                                    }
                                    document.getElementById(
                                        "blockWriteTable"
                                    ).innerHTML = list;
                                    // +
                                    // "<tr><td>" +
                                    // "timestamp" +
                                    // "</td><td>" +
                                    // timestamp +
                                    // "</yd></tr>";

                                    console.log("time", timestamp);
                            }
                        }
                    )
                }
                async function aa() {
                    console.log("Click");
                    var transactionNumberr1 =
                        document.getElementById("esId").innerHTML;
                    console.log(transactionNumberr1);

                    await web3.eth.getTransaction(
                        transactionNumberr1,
                        function (error, tx) {
                            console.log(tx);

                            let list = "";

                            for (var j in tx) {
                                console.log("forin", j);
                                console.log("forin", tx[j]);

                                if (j == "blockNumber") {
                                    list +=
                                        "<tr><td>" +
                                        j +
                                        "</td><td onclick='blockN()' id=blockNum'>" +
                                        tx[j] +
                                        "</td></tr>";
                                } else if (j == "form") {
                                    list +=
                                        "<tr><td>" +
                                        j +
                                        "</td><td onclick='formGo()' id=formGo'>" +
                                        tx[j] +
                                        "</td></tr>";
                                } else if (j == "to") {
                                    list +=
                                        "<tr><td>" +
                                        j +
                                        "</td><td onclick='toGo()' id='toGo'>" +
                                        tx[j] +
                                        "</td></tr>";
                                } else {
                                    list +=
                                        "<tr><td>" =
                                        j +
                                        "</td><td>" +
                                        tx[j] +
                                        "</td></tr>";
                                }
                            }
                            document.getElementById("blockWriteTable").innerHTML = list;
                        }
                    );
                }
                async function blockN() {
                    console.log("come in");
                    var blockNumberr1 =
                        document.getElementById("blockNum").innerHTML;

                    await web3.eth.getBlock(blockNumberr1,function (error,block) {
                        console.log(block);
                        let list = "";
                        for (var j in block) {
                            console.log("forin", j);
                            console.log("forin", block[j]);

                            if (j == "transactions") {
                                list +=
                                    "<tr><td>" +
                                    j +
                                    "</td><td onclick='aa()' id='esId'>" +
                                    block[j] +
                                    "</td></tr>";
                            } else {
                                list +=
                                    "<tr><td>" +
                                    j +
                                    "</td><td>" +
                                    block[j] +
                                    "</td></tr>";
                            }
                        }
                        document.getElementById("blockWriteTable").innerHTML = list;
                    });
                }
                async function fromGo() {
                    var from1 = document.getElementById("fromGo").innerHTML;
                    let balance = await web3.eth.getBalance(from1);
                    let list =
                        "<tr><td>" + from1 + "</td><td>" + balance + "</td></tr>";
                        // console.log(balance.length):
                    document.getElementById("blockWriteTable").innerHTML = list;
                }
                async function toGo() {
                    var to1 = document.getElementById("toGo").innerHTML;
                    let balance = await web3.eth.getBalance(to1);
                    let list =
                        "<tr><td>" + to1 + "</td><td>" + balance + "</td></tr>";
                    // console.log(balance.length);
                    document.getElementById("blockWriteTable").innerHTML = list;
                }
    </script>
</body>
</html>
<style>
    *{
        margin: 5px;
    }
    #allSearch {
        width: 90%;
    }
    .first {
        background-color:gray;
        /* background-image: url("https://hamonikr.org/files/attach/images/118/312/070/091a9004527320054613ddcdbda75b46.jpg"); */
    }
</style>